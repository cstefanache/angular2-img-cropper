{"version":3,"file":"init.spec.js","sourceRoot":"","sources":["../src/init.spec.ts"],"names":[],"mappings":";AAAA,IAAO,IAAI,WAAW,WAAW,CAAC,CAAA;AAClC,IAAO,OAAO,WAAW,SAAS,CAAC,CAAA;AACnC,mBAAuB,IACvB,CAAC,CAD0B;AAC3B,qBAAqB,MACrB,CAAC,CAD0B;AAC3B,qBAAqB,QACrB,CAAC,CAD4B;AAC7B,uBAA4B,gBAC5B,CAAC,CAD2C;AAC5C,mBAAyB,YAEzB,CAAC,CAFoC;AAErC,IAAI,CAAC,MAAM,EAAE,UAAA,CAAC;IACZ,CAAC,CAAC,IAAI,CAAC,oBAAoB,EAAE,UAAA,CAAC;QAC5B,IAAM,WAAW,GAAG,WAAI,CAAC,SAAS,EAAE,eAAe,CAAC,CAAA;QACpD,IAAM,IAAI,GAAG,WAAI,CAAC,WAAW,EAAE,oBAAW,CAAC,CAAA;QAE3C,MAAM,CAAC,WAAI,CAAC,EAAE,GAAG,EAAE,WAAW,EAAE,CAAC;aAC9B,IAAI,CAAC;YACJ,MAAM,CAAC,aAAQ,CAAC,IAAI,CAAC,CAAA;QACvB,CAAC,CAAC;aACD,IAAI,CAAC,UAAU,MAAM;YACpB,CAAC,CAAC,EAAE,CAAC,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAA;QAClC,CAAC,CAAC;aACD,IAAI,CAAC;YACJ,MAAM,CAAC,OAAO,CAAC,WAAM,CAAC,CAAC,IAAI,CAAC,CAAA;QAC9B,CAAC,CAAC,CAAA;IACN,CAAC,CAAC,CAAA;IAEF,CAAC,CAAC,IAAI,CAAC,kBAAkB,EAAE,UAAA,CAAC;QAC1B,IAAM,WAAW,GAAG,WAAI,CAAC,SAAS,EAAE,uBAAuB,CAAC,CAAA;QAC5D,IAAM,IAAI,GAAG,WAAI,CAAC,WAAW,EAAE,oBAAW,CAAC,CAAA;QAE3C,MAAM,CAAC,WAAI,CAAC,EAAE,GAAG,EAAE,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;aAC7C,IAAI,CAAC;YACJ,MAAM,CAAC,aAAQ,CAAC,IAAI,CAAC,CAAA;QACvB,CAAC,CAAC;aACD,IAAI,CAAC,UAAU,MAAM;YACpB,CAAC,CAAC,SAAS,CAAC,MAAM,EAAE;gBAClB,kBAAkB,EAAE;oBAClB,UAAU,EAAE,mDAAmD;wBAC7D,2DAA2D;oBAC7D,MAAM,EAAE,+CAA+C;wBACrD,uDAAuD;oBACzD,IAAI,EAAE,gGAAgG;iBACvG;aACF,CAAC,CAAA;QACJ,CAAC,CAAC;aACD,IAAI,CAAC;YACJ,MAAM,CAAC,OAAO,CAAC,WAAM,CAAC,CAAC,IAAI,CAAC,CAAA;QAC9B,CAAC,CAAC,CAAA;IACN,CAAC,CAAC,CAAA;IAEF,CAAC,CAAC,IAAI,CAAC,oBAAoB,EAAE,UAAA,CAAC;QAC5B,IAAM,WAAW,GAAG,WAAI,CAAC,SAAS,EAAE,0BAA0B,CAAC,CAAA;QAC/D,IAAM,IAAI,GAAG,WAAI,CAAC,WAAW,EAAE,oBAAW,CAAC,CAAA;QAE3C,MAAM,CAAC,WAAI,CAAC,EAAE,GAAG,EAAE,WAAW,EAAC,CAAC;aAC7B,IAAI,CAAC;YACJ,MAAM,CAAC,aAAQ,CAAC,IAAI,CAAC,CAAA;QACvB,CAAC,CAAC;aACD,IAAI,CAAC,UAAU,MAAM;YACpB,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,cAAc,CAAC,CAAA;QACvC,CAAC,CAAC;aACD,IAAI,CAAC;YACJ,MAAM,CAAC,OAAO,CAAC,WAAM,CAAC,CAAC,IAAI,CAAC,CAAA;QAC9B,CAAC,CAAC,CAAA;IACN,CAAC,CAAC,CAAA;AACJ,CAAC,CAAC,CAAA","sourcesContent":["import test = require('blue-tape')\nimport thenify = require('thenify')\nimport { unlink } from 'fs'\nimport { join } from 'path'\nimport { init } from './init'\nimport { CONFIG_FILE } from './utils/config'\nimport { readJson } from './utils/fs'\n\ntest('init', t => {\n  t.test('init an empty file', t => {\n    const FIXTURE_DIR = join(__dirname, '__test__/init')\n    const path = join(FIXTURE_DIR, CONFIG_FILE)\n\n    return init({ cwd: FIXTURE_DIR })\n      .then(function () {\n        return readJson(path)\n      })\n      .then(function (config) {\n        t.ok(typeof config === 'object')\n      })\n      .then(function () {\n        return thenify(unlink)(path)\n      })\n  })\n\n  t.test('upgrade from tsd', t => {\n    const FIXTURE_DIR = join(__dirname, '__test__/init-upgrade')\n    const path = join(FIXTURE_DIR, CONFIG_FILE)\n\n    return init({ cwd: FIXTURE_DIR, upgrade: true })\n      .then(function () {\n        return readJson(path)\n      })\n      .then(function (config) {\n        t.deepEqual(config, {\n          globalDependencies: {\n            codemirror: 'github:DefinitelyTyped/DefinitelyTyped/codemirror' +\n              '/codemirror.d.ts#01ce3ccf7f071514ff5057ef32a4550bf0b81dfe',\n            jquery: 'github:DefinitelyTyped/DefinitelyTyped/jquery' +\n              '/jquery.d.ts#01ce3ccf7f071514ff5057ef32a4550bf0b81dfe',\n            node: 'github:DefinitelyTyped/DefinitelyTyped/node/node.d.ts#3b2ed809b9e8f7dc4fcc1d80199129a0b73fb277'\n          }\n        })\n      })\n      .then(function () {\n        return thenify(unlink)(path)\n      })\n  })\n\n  t.test('guess project name', t => {\n    const FIXTURE_DIR = join(__dirname, '__test__/init-guess-name')\n    const path = join(FIXTURE_DIR, CONFIG_FILE)\n\n    return init({ cwd: FIXTURE_DIR})\n      .then(function () {\n        return readJson(path)\n      })\n      .then(function (config) {\n        t.equals(config.name, 'typings-test')\n      })\n      .then(function () {\n        return thenify(unlink)(path)\n      })\n  })\n})\n"]}