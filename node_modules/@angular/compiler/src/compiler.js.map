{"version":3,"file":"compiler.js","sourceRoot":"","sources":["../../../../modules/@angular/compiler/src/compiler.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {COMPILER_OPTIONS, Compiler, CompilerFactory, CompilerOptions, Inject, Injectable, Optional, PLATFORM_INITIALIZER, PlatformRef, Provider, ReflectiveInjector, TRANSLATIONS, TRANSLATIONS_FORMAT, Type, ViewEncapsulation, createPlatformFactory, isDevMode, platformCore} from '@angular/core';\n\nexport * from './template_parser/template_ast';\nexport {TEMPLATE_TRANSFORMS} from './template_parser/template_parser';\nexport {CompilerConfig, RenderTypes} from './config';\nexport * from './compile_metadata';\nexport * from './offline_compiler';\nexport {RuntimeCompiler} from './runtime_compiler';\nexport * from './url_resolver';\nexport * from './resource_loader';\n\nexport {DirectiveResolver} from './directive_resolver';\nexport {PipeResolver} from './pipe_resolver';\nexport {NgModuleResolver} from './ng_module_resolver';\n\nimport {TemplateParser} from './template_parser/template_parser';\nimport {HtmlParser} from './ml_parser/html_parser';\nimport {DirectiveNormalizer} from './directive_normalizer';\nimport {CompileMetadataResolver} from './metadata_resolver';\nimport {StyleCompiler} from './style_compiler';\nimport {ViewCompiler} from './view_compiler/view_compiler';\nimport {NgModuleCompiler} from './ng_module_compiler';\nimport {CompilerConfig} from './config';\nimport {RuntimeCompiler} from './runtime_compiler';\nimport {ElementSchemaRegistry} from './schema/element_schema_registry';\nimport {DomElementSchemaRegistry} from './schema/dom_element_schema_registry';\nimport {UrlResolver, DEFAULT_PACKAGE_URL_PROVIDER} from './url_resolver';\nimport {Parser} from './expression_parser/parser';\nimport {Lexer} from './expression_parser/lexer';\nimport {DirectiveResolver} from './directive_resolver';\nimport {PipeResolver} from './pipe_resolver';\nimport {NgModuleResolver} from './ng_module_resolver';\nimport {Console, Reflector, reflector, ReflectorReader, ReflectionCapabilities} from './private_import_core';\nimport {ResourceLoader} from './resource_loader';\nimport * as i18n from './i18n/index';\n\nconst _NO_RESOURCE_LOADER: ResourceLoader = {\n  get(url: string): Promise<string>{\n      throw new Error(\n          `No ResourceLoader implementation has been provided. Can't read the url \"${url}\"`);}\n};\n\n/**\n * A set of providers that provide `RuntimeCompiler` and its dependencies to use for\n * template compilation.\n */\nexport const COMPILER_PROVIDERS: Array<any|Type<any>|{[k: string]: any}|any[]> = [\n  {provide: Reflector, useValue: reflector},\n  {provide: ReflectorReader, useExisting: Reflector},\n  {provide: ResourceLoader, useValue: _NO_RESOURCE_LOADER},\n  Console,\n  Lexer,\n  Parser,\n  HtmlParser,\n  {\n    provide: i18n.I18NHtmlParser,\n    useFactory: (parser: HtmlParser, translations: string, format: string) =>\n                    new i18n.I18NHtmlParser(parser, translations, format),\n    deps: [\n      HtmlParser,\n      [new Optional(), new Inject(TRANSLATIONS)],\n      [new Optional(), new Inject(TRANSLATIONS_FORMAT)],\n    ]\n  },\n  TemplateParser,\n  DirectiveNormalizer,\n  CompileMetadataResolver,\n  DEFAULT_PACKAGE_URL_PROVIDER,\n  StyleCompiler,\n  ViewCompiler,\n  NgModuleCompiler,\n  {provide: CompilerConfig, useValue: new CompilerConfig()},\n  RuntimeCompiler,\n  {provide: Compiler, useExisting: RuntimeCompiler},\n  DomElementSchemaRegistry,\n  {provide: ElementSchemaRegistry, useExisting: DomElementSchemaRegistry},\n  UrlResolver,\n  DirectiveResolver,\n  PipeResolver,\n  NgModuleResolver\n];\n\n\n\nexport class RuntimeCompilerFactory implements CompilerFactory {\n  private _defaultOptions: CompilerOptions[];\n  constructor( defaultOptions: CompilerOptions[]) {\n    this._defaultOptions = [<CompilerOptions>{\n                             useDebug: isDevMode(),\n                             useJit: true,\n                             defaultEncapsulation: ViewEncapsulation.Emulated\n                           }].concat(defaultOptions);\n  }\n  createCompiler(options: CompilerOptions[] = []): Compiler {\n    const mergedOptions = _mergeOptions(this._defaultOptions.concat(options));\n    const injector = ReflectiveInjector.resolveAndCreate([\n      COMPILER_PROVIDERS, {\n        provide: CompilerConfig,\n        useFactory: () => {\n          return new CompilerConfig({\n            // let explicit values from the compiler options overwrite options\n            // from the app providers. E.g. important for the testing platform.\n            genDebugInfo: mergedOptions.useDebug,\n            // let explicit values from the compiler options overwrite options\n            // from the app providers\n            useJit: mergedOptions.useJit,\n            // let explicit values from the compiler options overwrite options\n            // from the app providers\n            defaultEncapsulation: mergedOptions.defaultEncapsulation,\n            logBindingUpdate: mergedOptions.useDebug\n          });\n        },\n        deps: []\n      },\n      mergedOptions.providers\n    ]);\n    return injector.get(Compiler);\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n{type: Array, decorators: [{ type: Inject, args: [COMPILER_OPTIONS, ] }, ]},\n];\n}\n\nfunction _initReflector() {\n  reflector.reflectionCapabilities = new ReflectionCapabilities();\n}\n\n/**\n * A platform that included corePlatform and the compiler.\n *\n * @experimental\n */\nexport const platformCoreDynamic = createPlatformFactory(platformCore, 'coreDynamic', [\n  {provide: COMPILER_OPTIONS, useValue: {}, multi: true},\n  {provide: CompilerFactory, useClass: RuntimeCompilerFactory},\n  {provide: PLATFORM_INITIALIZER, useValue: _initReflector, multi: true},\n]);\n\nfunction _mergeOptions(optionsArr: CompilerOptions[]): CompilerOptions {\n  return {\n    useDebug: _lastDefined(optionsArr.map(options => options.useDebug)),\n    useJit: _lastDefined(optionsArr.map(options => options.useJit)),\n    defaultEncapsulation: _lastDefined(optionsArr.map(options => options.defaultEncapsulation)),\n    providers: _mergeArrays(optionsArr.map(options => options.providers))\n  };\n}\n\nfunction _lastDefined<T>(args: T[]): T {\n  for (var i = args.length - 1; i >= 0; i--) {\n    if (args[i] !== undefined) {\n      return args[i];\n    }\n  }\n  return undefined;\n}\n\nfunction _mergeArrays(parts: any[][]): any[] {\n  let result: any[] = [];\n  parts.forEach((part) => part && result.push(...part));\n  return result;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}